<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Review UI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f7fa;
            margin: 0;
            padding: 0;
        }

        .container {
            width: 90%;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        h1 {
            text-align: center;
            font-size: 1.8em;
            margin-bottom: 20px;
        }

        .filters {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .filters select {
            padding: 8px;
            font-size: 1em;
            margin-right: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        .image-cell img {
            width: 100px;
            height: auto;
        }

    </style>
</head>
<body>

<div class="container">
    <h1>Team Review UI</h1>

    <!-- Filter Section -->
    <div class="filters">
        <select id="dateFilter">
            <option value="">Select Date</option>
        </select>
        <select id="enterpriseFilter">
            <option value="">Select Enterprise</option>
        </select>
        <select id="qcUserFilter">
            <option value="">Select QC User</option>
        </select>
        <select id="editingUserFilter">
            <option value="">Select Editing User</option>
        </select>
        <button onclick="applyFilters()">Apply Filters</button>
    </div>

    <!-- Data Table -->
    <table id="reviewTable">
        <thead>
            <tr>
                <th>Enterprise</th>
                <th>QC User</th>
                <th>Editing User</th>
                <th>Issue</th>
                <th>Date</th>
                <th>Sku ID</th>
                <th>Image ID</th>
                <th>Comments</th>
                <th>Input Image</th>
                <th>AI Image</th>
                <th>Final Image</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be filled here -->
        </tbody>
    </table>
</div>

<script>
    // Fetch CSV data from Google Sheets link
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSWW7muoNyeY_1VOLhybuT7ChNHtkhAscxDikyiCPQChIWqi1m3KXsd9e0_i_UFE7bDrW_7kfH-vIhL/pub?gid=1880564018&single=true&output=csv";

    let data = [];

    // Fetch and process the CSV
    fetch(csvUrl)
        .then(response => response.text())
        .then(csv => {
            const rows = csv.split("\n").map(row => row.split(","));
            // Extract headers
            const headers = rows[0];
            // Process data
            data = rows.slice(1).map(row => {
                return {
                    Timestamp: row[0],
                    Enterprise: row[1],
                    "QC User": row[2],
                    "Editing User": row[3],
                    "Issue": row[4],
                    "Date": row[5],
                    "Sku ID": row[6],
                    "Image ID": row[7],
                    "Comment": row[8],
                    "Input Image": row[9],
                    "AI Image": row[10],
                    "Final Image": row[11]
                };
            });
            populateFilters();
            renderTable();
        })
        .catch(error => console.error('Error fetching the CSV data:', error));

    // Populate filters with unique values
    function populateFilters() {
        const dateFilter = document.getElementById('dateFilter');
        const enterpriseFilter = document.getElementById('enterpriseFilter');
        const qcUserFilter = document.getElementById('qcUserFilter');
        const editingUserFilter = document.getElementById('editingUserFilter');

        // Get unique values for each filter
        const dates = new Set();
        const enterprises = new Set();
        const qcUsers = new Set();
        const editingUsers = new Set();

        data.forEach(item => {
            dates.add(item.Timestamp.split(" ")[0]);
            enterprises.add(item.Enterprise);
            qcUsers.add(item["QC User"]);
            editingUsers.add(item["Editing User"]);
        });

        // Populate Date Filter
        dates.forEach(date => {
            const option = document.createElement("option");
            option.value = date;
            option.textContent = date;
            dateFilter.appendChild(option);
        });

        // Populate Enterprise Filter
        enterprises.forEach(enterprise => {
            const option = document.createElement("option");
            option.value = enterprise;
            option.textContent = enterprise;
            enterpriseFilter.appendChild(option);
        });

        // Populate QC User Filter
        qcUsers.forEach(qcUser => {
            const option = document.createElement("option");
            option.value = qcUser;
            option.textContent = qcUser;
            qcUserFilter.appendChild(option);
        });

        // Populate Editing User Filter
        editingUsers.forEach(editingUser => {
            const option = document.createElement("option");
            option.value = editingUser;
            option.textContent = editingUser;
            editingUserFilter.appendChild(option);
        });
    }

    // Apply filters and render table
    function applyFilters() {
        renderTable();
    }

    // Render table with filtered data
    function renderTable() {
        const tableBody = document.getElementById('reviewTable').getElementsByTagName('tbody')[0];
        tableBody.innerHTML = '';

        const dateFilter = document.getElementById('dateFilter').value;
        const enterpriseFilter = document.getElementById('enterpriseFilter').value;
        const qcUserFilter = document.getElementById('qcUserFilter').value;
        const editingUserFilter = document.getElementById('editingUserFilter').value;

        const filteredData = data.filter(item => {
            return (
                (!dateFilter || item.Timestamp.split(" ")[0] === dateFilter) &&
                (!enterpriseFilter || item.Enterprise === enterpriseFilter) &&
                (!qcUserFilter || item["QC User"] === qcUserFilter) &&
                (!editingUserFilter || item["Editing User"] === editingUserFilter) &&
                item.Comment !== "Done"
            );
        });

        filteredData.forEach(item => {
            const row = tableBody.insertRow();
            row.innerHTML = `
                <td>${item.Enterprise}</td>
                <td>${item["QC User"]}</td>
                <td>${item["Editing User"]}</td>
                <td>${item.Issue}</td>
                <td>${item.Date}</td>
                <td>${item["Sku ID"]}</td>
                <td>${item["Image ID"]}</td>
                <td>${item.Comment}</td>
                <td class="image-cell"><img src="${item["Input Image"]}" alt="Input Image"></td>
                <td class="image-cell"><img src="${item["AI Image"]}" alt="AI Image"></td>
                <td class="image-cell"><img src="${item["Final Image"]}" alt="Final Image"></td>
            `;
        });
    }
</script>

</body>
</html>
